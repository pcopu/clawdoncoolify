services:
  clawdbot:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        CLAWDBOT_REPO: ${CLAWDBOT_REPO:-https://github.com/clawdbot/clawdbot}
        CLAWDBOT_REF: ${CLAWDBOT_REF:-main}
        CLAWDBOT_DOCKER_APT_PACKAGES: ${CLAWDBOT_DOCKER_APT_PACKAGES:-}
    environment:
      CLAWDBOT_AUTH_CHOICE: ${CLAWDBOT_AUTH_CHOICE:-}
      CLAWDBOT_GATEWAY_TOKEN: ${CLAWDBOT_GATEWAY_TOKEN:-}
      CLAWDBOT_GATEWAY_BIND: ${CLAWDBOT_GATEWAY_BIND:-lan}
      CLAWDBOT_GATEWAY_PORT: ${CLAWDBOT_GATEWAY_PORT:-18789}
      CLAWDBOT_BRIDGE_PORT: ${CLAWDBOT_BRIDGE_PORT:-18790}
      CLAWDBOT_STATE_DIR: ${CLAWDBOT_STATE_DIR:-/home/node/.clawdbot}
      CLAWDBOT_WORKSPACE_DIR: ${CLAWDBOT_WORKSPACE_DIR:-/home/node/clawd}
      CLAWDBOT_FORCE_ONBOARD: ${CLAWDBOT_FORCE_ONBOARD:-0}
      CLAWDBOT_PRINT_DASHBOARD_URL: ${CLAWDBOT_PRINT_DASHBOARD_URL:-1}
      CLAWDBOT_REQUIRE_PROVIDER: ${CLAWDBOT_REQUIRE_PROVIDER:-1}
      CLAWDBOT_SKIP_HEALTH: ${CLAWDBOT_SKIP_HEALTH:-1}
      CLAWDBOT_SKIP_UI: ${CLAWDBOT_SKIP_UI:-1}
      CLAWDBOT_SKIP_CHANNELS: ${CLAWDBOT_SKIP_CHANNELS:-1}
      CLAWDBOT_SKIP_SKILLS: ${CLAWDBOT_SKIP_SKILLS:-1}

      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY:-}
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
      OPENROUTER_API_KEY: ${OPENROUTER_API_KEY:-}
      AI_GATEWAY_API_KEY: ${AI_GATEWAY_API_KEY:-}
      GEMINI_API_KEY: ${GEMINI_API_KEY:-}
      ZAI_API_KEY: ${ZAI_API_KEY:-}
      MOONSHOT_API_KEY: ${MOONSHOT_API_KEY:-}
      MINIMAX_API_KEY: ${MINIMAX_API_KEY:-}
      SYNTHETIC_API_KEY: ${SYNTHETIC_API_KEY:-}
      OPENCODE_API_KEY: ${OPENCODE_API_KEY:-}
      CLAWDBOT_TOKEN_PROVIDER: ${CLAWDBOT_TOKEN_PROVIDER:-}
      CLAWDBOT_TOKEN: ${CLAWDBOT_TOKEN:-}
    ports:
      - "${CLAWDBOT_GATEWAY_PORT:-18789}:${CLAWDBOT_GATEWAY_PORT:-18789}"
      - "${CLAWDBOT_BRIDGE_PORT:-18790}:${CLAWDBOT_BRIDGE_PORT:-18790}"
    volumes:
      - clawdbot_state:/home/node/.clawdbot
      - clawdbot_workspace:/home/node/clawd
    restart: unless-stopped

volumes:
  clawdbot_state:
  clawdbot_workspace:
